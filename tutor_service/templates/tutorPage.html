{% extends 'base.html'%}

{% block head %}
Tutor Page
{% endblock %}
<link rel="stylesheet" href="style/tutorPage.css">
const tutorSchedule = [];

<!--
    Table Row (tr)
    Table Data (td), the content of the table cell
    Table Header (th), text in th elements are bold and centered by default
-->

{% block body %}

<style>
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
    align-content: center;
    background-color: white;
  }
  #schedule{
    background: white;
  }

  td, th {
    padding: 10px;
  }
  .popup {
    position: relative;
    display: inline-block;
  }

  .popup .popuptext {
    visibility: hidden;
    width: 180px;
    background-color: #555;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -80px;
  }
  .popup .show {
    visibility: visible;
    /*-webkit-animation: fadeIn 1s;*/
    animation: fadeIn 1s
  }
  /*@-webkit-keyframes fadeIn {*/
  /*  from {opacity: 0;}*/
  /*  to {opacity: 1;}*/
  /*}*/

</style>

<h1>Tutor Schedule</h1>

<div class = "popup" >
  <button type="button" onclick="popUp()">Save Schedule</button>
  <span class="popuptext" id="myPopup">Schedule saved!</span>
</div>

<button onclick="refreshBackground()">Refresh Schedule</button>
<div id = "tableSchedule">

  <table id ="schedule">
    <thead>
    <tr>
      <!--
  <th scope="col" rowspan="2">Start Time</th>
  <th scope="col" rowspan="2">End Time</th>
      -->
      <th></th>
      <th></th>
      {% for day in weekdays %}
      <th id = "weekday" scope="col" colspan="1">{{ day }}</th>
      {% endfor %}
    </tr>

    </thead>
    <tbody>
    <tr>
      <th scope="col">Start Time</th>
      <th scope="col">End Time</th>

      {% for day in weekdays %}

      <th scope="col">Available</th>

      {% endfor %}
    </tr>
    {% for timeL in times %}

    <tr>
      <td class = "start" >{{ timeL[0] }}</td>
      <td class = "end" >{{ timeL[1] }}</td>

      {% for x in range(total_cols) %}
      <form method = "POST">
          <td class = "data" onclick = "changeColor('springgreen')"> </td>
      </form>
      {% endfor %}
    </tr>
    {% endfor %}
    </tbody>

  </table>
</div>

<script>

  function changeColor(color) {
    // window.alert("in change color function");
    el = event.target
    var row = el.parentNode.rowIndex;
    var col = el.closest("td").cellIndex;

    if(el.style.backgroundColor !== color){
        el.style.backgroundColor = color;
        addToSchedule(row, col);
    }
    else{
      el.style.backgroundColor = el.parentNode.style.backgroundColor;
    }
  }

  function addToSchedule(row, col){
    //row 0 col 2:8 are the weekdays
    //row 2:27 col 0 are start times
    //row 2:27 col 1 are end times

    var table = document.getElementById("schedule");
    var weekday = table.rows[0].cells[col].innerText;
    var startT = table.rows[row].cells[0].innerText;
    var endT = table.rows[row].cells[1].innerText;
    // tutorSchedule.push(weekday);
    // tutorSchedule.push(startT);
    // tutorSchedule.push(endT);
    window.alert(weekday + " " + startT + " " + endT);
  }

  function refreshBackground() {
    const d = document.getElementsByClassName("data");
    for (var i = 0; i < d.length; i++) {
      d[i].style.backgroundColor = "white";
    }
  }

</script>
def popUp():
  var popup = document.getElementById("myPopup");
  popup.classList.toggle("show");

{% endblock %}